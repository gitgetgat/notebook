# tree shaking 原理是什么？

<article-info/>

`webpack` 中，`Tree shaking` 是一种通过清除多余代码方式来优化项目打包体积的技术，清除一些被 import 了但其实没有被使用的代码。
实现原理
`Tree-shaking` 的实现一是先标记出模块导出值中哪些没有被用过，二是使用 `Terser` 删掉这些没被用到的导出语句。标记过程大致可划分为三个步骤：

1. `Make` 阶段，收集模块导出变量并记录到模块依赖关系图 `ModuleGraph` 变量中
2. `Seal` 阶段，遍历 `ModuleGraph` 标记模块导出变量有没有被使用
3. 生成产物时，若变量没有被其它模块使用则删除对应的导出语句

标记功能只会影响到模块的导出语句，真正执行 `“「Shaking」”` 操作的是 `Terser` 插件。只需要用 `Terser` 提供的 `DCE` 功能就可以删除这一段定义语句（不可能被执行到的代码），以此实现完整的 `Tree Shaking` 效果。
